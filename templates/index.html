<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Matchmaking Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root{
            --bg: #0b1220; --card: rgba(255,255,255,0.08); --glass: rgba(255,255,255,0.12);
            --text:#e9eefc; --muted:#a6b1d0; --primary:#6c8bff; --primary-2:#9b6cff; --accent:#22e3a1;
        }
        body{background: radial-gradient(1200px 600px at 80% -10%, rgba(108,139,255,.25), transparent 60%), radial-gradient(900px 500px at -10% 20%, rgba(155,108,255,.25), transparent 60%), var(--bg); color: var(--text)}
        .navbar{backdrop-filter: blur(10px); background: linear-gradient(90deg, rgba(12,18,32,.8), rgba(12,18,32,.6)); border-bottom:1px solid rgba(255,255,255,.06)}
        
        /* Logo Styles */
        .logo-container {
            display: flex;
            align-items: center;
            position: relative;
            padding: 8px 12px;
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .logo-container:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            background: rgba(255,255,255,0.08);
        }
        
        .logo-icon {
            color: #4FC3F7;
            font-size: 1.5rem;
            margin-right: 10px;
            filter: drop-shadow(0 0 8px rgba(79, 195, 247, 0.5));
            transition: all 0.3s ease;
        }
        
        .logo-container:hover .logo-icon {
            transform: scale(1.1);
            filter: drop-shadow(0 0 12px rgba(79, 195, 247, 0.8));
        }
        
               .logo-text {
           font-size: 1.4rem;
           font-weight: 700;
           background: linear-gradient(135deg, #9C27B0 0%, #E91E63 100%);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           text-shadow: 0 2px 4px rgba(0,0,0,0.3);
           position: relative;
           z-index: 2;
           animation: float 3s ease-in-out infinite;
       }
       
       @keyframes float {
           0%, 100% {
               transform: translateY(0px);
           }
           50% {
               transform: translateY(-8px);
           }
       }
        
        .logo-underline {
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: linear-gradient(135deg, #9C27B0 0%, #E91E63 100%);
            border-radius: 1px;
            box-shadow: 0 0 8px rgba(156, 39, 176, 0.5);
        }
        
        .hero-section {
            background: linear-gradient(135deg, rgba(108,139,255,.35) 0%, rgba(155,108,255,.35) 100%);
            color: white;
            padding: 100px 0;
        }
        /* Flip Card Styles */
        .flip-card {
            background-color: transparent;
            width: 100%;
            height: 300px;
            perspective: 1000px;
            border-radius: 18px;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
            border-radius: 18px;
        }

        .flip-card:hover .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 18px;
            backdrop-filter: blur(10px);
            background: var(--card);
            box-shadow: 0 12px 40px rgba(0,0,0,.35);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .flip-card-front {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flip-card-back {
            background: linear-gradient(135deg, #9C27B0 0%, #6C8BFF 100%);
            transform: rotateY(180deg);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flip-card-back .card-body {
            color: white;
        }

        .flip-card-back ul li {
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .flip-card-back .fas {
            color: #22e3a1;
        }

        /* Scrolling Text Banner Styles */
        .scrolling-banner {
            background: linear-gradient(135deg, rgba(108,139,255,.15) 0%, rgba(155,108,255,.15) 100%);
            border-top: 1px solid rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }

        .scrolling-container {
            width: 100%;
            overflow: hidden;
            position: relative;
        }

        .scrolling-text {
            display: flex;
            white-space: nowrap;
            animation: scroll-left 20s linear infinite;
        }

        .scroll-item {
            display: inline-block;
            padding: 0 30px;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text);
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #9C27B0 0%, #6C8BFF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-right: 20px;
            transition: all 0.3s ease;
        }

        .scroll-item:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        /* Choose Your Role Title Styling */
        .choose-role-title {
            font-size: 3.5rem;
            font-weight: 800;
            color: white;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            letter-spacing: 1px;
        }

        .gradient-underline {
            width: 200px;
            height: 6px;
            background: linear-gradient(90deg, #22e3a1 0%, #9C27B0 100%);
            margin: 0 auto;
            border-radius: 3px;
            box-shadow: 0 2px 8px rgba(34, 227, 161, 0.4), 0 2px 8px rgba(156, 39, 176, 0.4);
        }

        /* Complete Your Details Section Styling */
        .complete-details-header {
            position: relative;
            display: inline-block;
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .complete-details-header::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, #22e3a1 0%, #6C8BFF 100%);
            border-radius: 2px 0 0 2px;
        }

        .complete-details-title {
            color: white;
            font-weight: 700;
            font-size: 1.8rem;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* Role Selection Cards */
        .role-selection-card {
            background: linear-gradient(135deg, #9C27B0 0%, #6C8BFF 100%);
            border-radius: 18px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .role-selection-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .role-selection-card:hover::before {
            left: 100%;
        }

        .role-selection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .role-selection-card.active {
            background: linear-gradient(135deg, #22e3a1 0%, #00BCD4 100%);
            border: 2px solid white;
            box-shadow: 0 10px 30px rgba(34, 227, 161, 0.3);
        }

        .role-title {
            color: white;
            font-weight: 700;
            font-size: 1.4rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .role-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1rem;
            margin: 0;
            font-weight: 500;
        }

        /* Icon rotation animation for role selection cards */
        .role-selection-card i {
            transition: transform 0.8s ease-in-out;
        }

        .role-selection-card:hover i {
            transform: rotateY(720deg);
        }

        .feature-card {
            border: none; border-radius: 18px; backdrop-filter: blur(10px);
            background: var(--card);
            box-shadow: 0 12px 40px rgba(0,0,0,.35);
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .user-type-card {
            cursor: pointer;
            transition: all 0.3s ease;
            border: none; border-radius: 18px; backdrop-filter: blur(10px);
            background: var(--card);
            box-shadow: 0 12px 40px rgba(0,0,0,.35);
        }
        .user-type-card:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
                 .form-container {
             background: var(--card);
             border-radius: 20px;
             box-shadow: 0 20px 40px rgba(0,0,0,0.1);
             padding: 40px;
             backdrop-filter: blur(10px);
             border: 1px solid rgba(255,255,255,0.1);
             margin-bottom: 30px;
             min-height: 600px;
         }
        .stats-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-2) 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .card {
            border: none; border-radius: 18px; backdrop-filter: blur(10px);
            background: var(--card);
            box-shadow: 0 12px 40px rgba(0,0,0,.35);
            margin-bottom: 20px;
        }
        .card-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-2) 100%);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            font-weight: bold;
        }
                 .btn-primary, .btn-gradient, .btn-success {
             background: linear-gradient(135deg, var(--primary) 0%, var(--primary-2) 100%);
             border: none;
             border-radius: 10px;
             padding: 12px 30px;
             font-weight: 600;
             color: white !important;
             text-decoration: none;
             display: inline-block;
             margin: 10px 5px;
         }
         .btn-primary:hover, .btn-gradient:hover, .btn-success:hover {
             transform: translateY(-2px);
             box-shadow: 0 10px 20px rgba(108,139,255,0.3);
             color: white !important;
             text-decoration: none;
         }
         .btn-success {
             background: linear-gradient(45deg, #15c97a, #13b0e0) !important;
         }
         .btn-success:hover {
             box-shadow: 0 10px 20px rgba(21,201,122,0.3);
         }
        .form-control, .form-select {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text) !important;
            border-radius: 10px;
        }
        .form-control:focus, .form-select:focus {
            background: rgba(255,255,255,0.15);
            border-color: var(--primary);
            color: var(--text) !important;
            box-shadow: 0 0 0 0.2rem rgba(108,139,255,0.25);
        }
        .form-control::placeholder {
            color: var(--muted);
        }
        .form-control::value {
            color: var(--text) !important;
        }
        .form-label {
            color: var(--text);
            font-weight: 600;
        }
        .form-text {
            color: var(--muted);
        }
        .alert {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text);
            backdrop-filter: blur(10px);
        }
        .alert-success {
            background: linear-gradient(45deg, rgba(21,201,122,0.2), rgba(19,176,224,0.2));
            border-color: rgba(21,201,122,0.3);
        }
        .loading-spinner {
            display: none;
        }
                 /* Additional form styling to ensure visibility */
         input[type="text"], input[type="email"], input[type="tel"], input[type="number"], 
         input[type="password"], textarea, select {
             color: var(--text) !important;
             background: rgba(255,255,255,0.1) !important;
             border: 1px solid rgba(255,255,255,0.2) !important;
         }
         input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus, 
         input[type="number"]:focus, input[type="password"]:focus, textarea:focus, select:focus {
             color: var(--text) !important;
             background: rgba(255,255,255,0.15) !important;
             border-color: var(--primary) !important;
             box-shadow: 0 0 0 0.2rem rgba(108,139,255,0.25) !important;
         }
         /* Ensure text is visible when typing */
         input[type="text"]::value, input[type="email"]::value, input[type="tel"]::value, 
         input[type="number"]::value, input[type="password"]::value {
             color: var(--text) !important;
         }
         /* Fix dropdown options visibility */
         .form-select option {
             background-color: #1a1a1a !important;
             color: #ffffff !important;
             padding: 8px 12px !important;
         }
         .form-select option:hover {
             background-color: var(--primary) !important;
             color: #ffffff !important;
         }
         .form-select option:checked {
             background-color: var(--primary) !important;
             color: #ffffff !important;
         }
         /* Override Bootstrap dropdown styling */
         .dropdown-menu {
             background-color: #1a1a1a !important;
             border: 1px solid rgba(255,255,255,0.2) !important;
         }
         .dropdown-item {
             color: #ffffff !important;
             background-color: transparent !important;
         }
         .dropdown-item:hover {
             background-color: var(--primary) !important;
             color: #ffffff !important;
         }
                 .success-message {
             display: none;
             background: linear-gradient(45deg, #15c97a, #13b0e0);
             color: white;
             padding: 15px;
             border-radius: 10px;
             margin-top: 15px;
         }
         .text-center {
             text-align: center !important;
         }
         .mt-3 {
             margin-top: 1rem !important;
         }
         .d-none {
             display: none !important;
         }
         .hint {
             color: var(--muted);
             font-size: 0.875rem;
             margin-top: 0.25rem;
         }
         /* Animation styles */
         .animate-text {
             display: inline-block;
             animation: fadeInUp 0.8s ease-out;
         }
         .animate-text:nth-child(1) { animation-delay: 0.1s; }
         .animate-text:nth-child(2) { animation-delay: 0.3s; }
         .animate-text:nth-child(3) { animation-delay: 0.5s; }
         
         @keyframes fadeInUp {
             from {
                 opacity: 0;
                 transform: translateY(30px);
             }
             to {
                 opacity: 1;
                 transform: translateY(0);
             }
         }
         
         /* Floating hero text animation */
         .floating-hero-text {
             animation: heroFloat 4s ease-in-out infinite;
             text-shadow: 0 4px 8px rgba(0,0,0,0.3);
         }
         
         @keyframes heroFloat {
             0%, 100% {
                 transform: translateY(0px);
             }
             50% {
                 transform: translateY(-12px);
             }
         }
         
                   .user-type-card {
              cursor: pointer;
              transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
              border: none; border-radius: 18px; backdrop-filter: blur(10px);
              background: var(--card);
              box-shadow: 0 12px 40px rgba(0,0,0,.35);
              position: relative;
              overflow: hidden;
              animation: cardFloat 3s ease-in-out infinite;
          }
          
          .user-type-card:nth-child(1) {
              animation-delay: 0s;
          }
          .user-type-card:nth-child(2) {
              animation-delay: 0.5s;
          }
          .user-type-card:nth-child(3) {
              animation-delay: 1s;
          }
          
          @keyframes cardFloat {
              0%, 100% {
                  transform: translateY(0px);
              }
              50% {
                  transform: translateY(-8px);
              }
          }
          
          .user-type-card::before {
              content: '';
              position: absolute;
              top: 0;
              left: -100%;
              width: 100%;
              height: 100%;
              background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
              transition: left 0.5s;
          }
          .user-type-card:hover::before {
              left: 100%;
          }
          .user-type-card:hover {
              transform: scale(1.05) translateY(-10px);
              box-shadow: 0 20px 50px rgba(0,0,0,0.4);
              animation: none;
          }
                   .user-type-card i {
              transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
              transform-origin: center;
          }
          .user-type-card:hover i {
              transform: scale(1.3) rotate(15deg);
              filter: brightness(1.2) drop-shadow(0 0 10px rgba(108,139,255,0.6));
          }
          
          /* Enhanced icon animations for each card type */
          .user-type-card:nth-child(1):hover i {
              transform: scale(1.3) rotate(15deg) translateY(-5px);
              filter: brightness(1.3) drop-shadow(0 0 15px rgba(108,139,255,0.8));
          }
          
          .user-type-card:nth-child(2):hover i {
              transform: scale(1.3) rotate(-15deg) translateY(-5px);
              filter: brightness(1.3) drop-shadow(0 0 15px rgba(40,167,69,0.8));
          }
          
          .user-type-card:nth-child(3):hover i {
              transform: scale(1.3) rotate(10deg) translateY(-5px);
              filter: brightness(1.3) drop-shadow(0 0 15px rgba(255,193,7,0.8));
          }
          
          .icon-wrapper {
              position: relative;
              display: inline-block;
          }
          
          .icon-wrapper::after {
              content: '';
              position: absolute;
              top: 50%;
              left: 50%;
              width: 80px;
              height: 80px;
              background: radial-gradient(circle, rgba(108,139,255,0.1) 0%, transparent 70%);
              border-radius: 50%;
              transform: translate(-50%, -50%);
              transition: all 0.3s ease;
          }
          
          .user-type-card:hover .icon-wrapper::after {
              width: 100px;
              height: 100px;
              background: radial-gradient(circle, rgba(108,139,255,0.2) 0%, transparent 70%);
          }
          
          .features-list {
              border-top: 1px solid rgba(255,255,255,0.1);
              padding-top: 15px;
              margin-top: 15px;
          }
          
          .user-type-card:hover .features-list {
              border-top-color: rgba(108,139,255,0.3);
          }
          
          /* Special animations for Property Owner and Franchise Company cards */
          .user-type-card:nth-child(1) .icon-wrapper i {
              animation: buildingPulse 2s ease-in-out infinite;
          }
          
          .user-type-card:nth-child(2) .icon-wrapper i {
              animation: storeGlow 2.5s ease-in-out infinite;
          }
          
          @keyframes buildingPulse {
              0%, 100% {
                  transform: scale(1);
                  filter: brightness(1);
              }
              50% {
                  transform: scale(1.1);
                  filter: brightness(1.3);
              }
          }
          
          @keyframes storeGlow {
              0%, 100% {
                  transform: scale(1);
                  filter: brightness(1) drop-shadow(0 0 5px rgba(40, 167, 69, 0.5));
              }
              50% {
                  transform: scale(1.15);
                  filter: brightness(1.4) drop-shadow(0 0 15px rgba(40, 167, 69, 0.8));
              }
          }
          
          /* Enhanced hover effects for Property Owner and Franchise Company */
          .user-type-card:nth-child(1):hover {
              background: linear-gradient(135deg, rgba(108,139,255,0.15), rgba(108,139,255,0.05));
              border: 1px solid rgba(108,139,255,0.3);
          }
          
          .user-type-card:nth-child(2):hover {
              background: linear-gradient(135deg, rgba(40,167,69,0.15), rgba(40,167,69,0.05));
              border: 1px solid rgba(40,167,69,0.3);
          }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <div class="logo-container">
                    <i class="fas fa-handshake logo-icon"></i>
                    <span class="logo-text">Match Square</span>
                    <div class="logo-underline"></div>
                </div>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#features">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#register">Register</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/recommendations">View Recommendations</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-4 floating-hero-text">
                Connect Properties, Franchises & Entrepreneurs
            </h1>
            <p class="lead mb-5">
                Powered by Foursquare's location intelligence and AI-driven matchmaking
            </p>
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="stats-card p-3">
                                <h3 id="propertyCount">0</h3>
                                <p class="mb-0">Properties</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stats-card p-3">
                                <h3 id="franchiseCount">0</h3>
                                <p class="mb-0">Franchises</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stats-card p-3">
                                <h3 id="entrepreneurCount">0</h3>
                                <p class="mb-0">Entrepreneurs</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Scrolling Text Banner -->
    <section class="scrolling-banner py-4">
        <div class="scrolling-container">
            <div class="scrolling-text">
                <span class="scroll-item">🏢 Property Owners</span>
                <span class="scroll-item">🏪 Franchise Companies</span>
                <span class="scroll-item">💡 Entrepreneurs</span>
                <span class="scroll-item">🤝 Match Square</span>
                <span class="scroll-item">🏢 Property Owners</span>
                <span class="scroll-item">🏪 Franchise Companies</span>
                <span class="scroll-item">💡 Entrepreneurs</span>
                <span class="scroll-item">🤝 Match Square</span>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="choose-role-title">Choose Your Role</h2>
                <div class="gradient-underline"></div>
            </div>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="flip-card">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="card-body text-center">
                                    <i class="fas fa-building fa-3x text-primary mb-3"></i>
                                    <h5 class="card-title">Property Owners</h5>
                                    <p class="card-text">
                                        List properties, get AI pricing, market insights, and franchise matches.
                                    </p>
                                    <small class="text-muted">Hover to learn more</small>
                                </div>
                            </div>
                            <div class="flip-card-back">
                                <div class="card-body text-center">
                                    <h5 class="card-title">What We Do For You</h5>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check-circle text-success me-2"></i>AI-powered pricing analysis</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Market demand assessment</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Tenant matching</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Competition analysis</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Feasibility studies</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Screening tools</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="flip-card">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="card-body text-center">
                                    <i class="fas fa-store fa-3x text-success mb-3"></i>
                                    <h5 class="card-title">Franchise Companies</h5>
                                    <p class="card-text">
                                        Find ideal locations and connect with interested entrepreneurs.
                                    </p>
                                    <small class="text-muted">Hover to learn more</small>
                                </div>
                            </div>
                            <div class="flip-card-back">
                                <div class="card-body text-center">
                                    <h5 class="card-title">What We Do For You</h5>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Location scouting & analysis</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Entrepreneur matching</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Market demand assessment</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Competition analysis</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Feasibility studies</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Screening tools</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="flip-card">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="card-body text-center">
                                    <i class="fas fa-lightbulb fa-3x text-warning mb-3"></i>
                                    <h5 class="card-title">Entrepreneurs</h5>
                                    <p class="card-text">
                                        Discover opportunities, get location recos, and pick the right property.
                                    </p>
                                    <small class="text-muted">Hover to learn more</small>
                                </div>
                            </div>
                            <div class="flip-card-back">
                                <div class="card-body text-center">
                                    <h5 class="card-title">What We Do For You</h5>
                                    <ul class="list-unstyled">
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Business opportunity discovery</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Location recommendations</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Property matching</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Franchise opportunities</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Investment analysis</li>
                                        <li><i class="fas fa-check-circle text-success me-2"></i>Risk assessment</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

         <!-- Registration Section -->
     <section id="register" class="py-5">
         <div class="container">
             <!-- Complete Your Details Title -->
             <div class="complete-details-header mb-5">
                 <h2 class="complete-details-title">Complete Your Details</h2>
             </div>
            
             <!-- User Type Selection -->
             <div class="row justify-content-center mb-5">
                 <div class="col-md-10">
                     <div class="row g-4">
                         <div class="col-md-4">
                             <div class="role-selection-card" onclick="showRegistrationForm('property-owner')">
                                 <div class="card-body text-center">
                                     <i class="fas fa-building fa-3x text-white mb-3"></i>
                                     <h5 class="role-title">Property Owner</h5>
                                     <p class="role-subtitle">List your properties</p>
                                 </div>
                             </div>
                         </div>
                         <div class="col-md-4">
                             <div class="role-selection-card active" onclick="showRegistrationForm('franchise-company')">
                                 <div class="card-body text-center">
                                     <i class="fas fa-store fa-3x text-white mb-3"></i>
                                     <h5 class="role-title">Franchise Company</h5>
                                     <p class="role-subtitle">Expand your franchise</p>
                                 </div>
                             </div>
                         </div>
                         <div class="col-md-4">
                             <div class="role-selection-card" onclick="showRegistrationForm('entrepreneur')">
                                 <div class="card-body text-center">
                                     <i class="fas fa-lightbulb fa-3x text-white mb-3"></i>
                                     <h5 class="role-title">Entrepreneur</h5>
                                     <p class="role-subtitle">Find opportunities</p>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             </div>

            <!-- Registration Forms -->
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <!-- Property Owner Form -->
                    <div id="property-owner-form" class="form-container" style="display: none;">
                        <h3 class="text-center mb-4">Property Owner Registration</h3>
                        <form id="propertyOwnerForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Name</label>
                                    <input type="text" class="form-control" name="name" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" name="email" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Property Type</label>
                                    <select class="form-select" name="property_type" required>
                                        <option value="">Select type</option>
                                        <option value="commercial">Commercial</option>
                                        <option value="retail">Retail</option>
                                        <option value="office">Office</option>
                                        <option value="industrial">Industrial</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Size (sq ft)</label>
                                    <input type="number" class="form-control" name="size" required>
                                </div>
                            </div>
                                                         <div class="mb-3">
                                 <label class="form-label">Pincode/Postal Code</label>
                                 <input type="text" class="form-control" name="pincode" placeholder="Enter property pincode (e.g., 400001)" required>
                                 <small class="form-text text-muted">We'll automatically convert this to coordinates for location-based analysis</small>
                             </div>
                            <div class="mb-3">
                                <label class="form-label">Address</label>
                                <input type="text" class="form-control" name="address" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Monthly Rent (₹)</label>
                                    <input type="number" class="form-control icon icon-currency" name="rent_amount" placeholder="e.g. 50000" min="0">
                                    <div class="hint">Leave empty if not for rent</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Sale Price (₹)</label>
                                    <input type="number" class="form-control icon icon-currency" name="sale_price" placeholder="e.g. 5000000" min="0">
                                    <div class="hint">Leave empty if not for sale</div>
                                </div>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-gradient btn-lg" id="propertySubmitBtn">
                                    <span class="btn-text">Register Property</span>
                                    <span class="btn-spinner d-none">
                                        <i class="fas fa-spinner fa-spin me-2"></i>Registering...
                                    </span>
                                </button>
                                <div class="mt-3 d-none" id="propertySuccessDiv">
                                    <div class="alert alert-success">
                                        <i class="fas fa-check-circle me-2"></i>Registration successful!
                                    </div>
                                    <a href="/recommendations" class="btn btn-success btn-lg">
                                        <i class="fas fa-chart-line me-2"></i>View Recommendations
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Franchise Company Form -->
                    <div id="franchise-company-form" class="form-container" style="display: none;">
                        <h3 class="text-center mb-4">Franchise Company Registration</h3>
                        <form id="franchiseCompanyForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Company Name</label>
                                    <input type="text" class="form-control" name="company_name" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" name="email" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Franchise Category</label>
                                    <select class="form-select" name="category" required>
                                        <option value="">Select category</option>
                                        <option value="food_beverage">Food & Beverage</option>
                                        <option value="retail">Retail</option>
                                        <option value="services">Services</option>
                                        <option value="healthcare">Healthcare</option>
                                        <option value="education">Education</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Investment Required</label>
                                    <input type="number" class="form-control" name="investment_required" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Franchise Description</label>
                                <textarea class="form-control" name="description" rows="3" required></textarea>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Target Pincode/Postal Code</label>
                                    <input type="text" class="form-control" name="pincode" placeholder="Enter target pincode (e.g., 400001)" required>
                                    <small class="form-text text-muted">We'll use this to find suitable locations for your franchise</small>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Area Size Required (sq ft)</label>
                                    <input type="number" class="form-control" name="area_size" placeholder="e.g. 1000" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Target Location Description</label>
                                <textarea class="form-control" name="location_description" rows="2" placeholder="Describe your ideal location (e.g., near shopping mall, high foot traffic area, etc.)"></textarea>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-gradient btn-lg" id="franchiseSubmitBtn">
                                    <span class="btn-text">Register Franchise</span>
                                    <span class="btn-spinner d-none">
                                        <i class="fas fa-spinner fa-spin me-2"></i>Registering...
                                    </span>
                                </button>
                                <div class="mt-3 d-none" id="franchiseSuccessDiv">
                                    <div class="alert alert-success">
                                        <i class="fas fa-check-circle me-2"></i>Registration successful!
                                    </div>
                                    <a href="/recommendations" class="btn btn-success btn-lg">
                                        <i class="fas fa-chart-line me-2"></i>View Recommendations
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Entrepreneur Form -->
                    <div id="entrepreneur-form" class="form-container" style="display: none;">
                        <h3 class="text-center mb-4">Entrepreneur Registration</h3>
                        <form id="entrepreneurForm">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Name</label>
                                    <input type="text" class="form-control" name="name" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" name="email" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone" required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Entrepreneur Type</label>
                                    <select class="form-select" name="entrepreneur_type" required>
                                        <option value="">Select type</option>
                                        <option value="investor">Investor (Has money)</option>
                                        <option value="idea_owner">Idea Owner (Has business idea)</option>
                                        <option value="both">Both (Has money and idea)</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Budget</label>
                                    <input type="number" class="form-control" name="budget" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Pincode/Postal Code</label>
                                <input type="text" class="form-control" name="pincode" placeholder="Enter your pincode for location-based recommendations" required>
                                <small class="form-text text-muted">We'll use this to find location-specific business opportunities for you</small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Business Idea (Optional)</label>
                                <textarea class="form-control" name="business_idea" rows="3"></textarea>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-gradient btn-lg" id="entrepreneurSubmitBtn">
                                    <span class="btn-text">Register Entrepreneur</span>
                                    <span class="btn-spinner d-none">
                                        <i class="fas fa-spinner fa-spin me-2"></i>Registering...
                                    </span>
                                </button>
                                <div class="mt-3 d-none" id="entrepreneurSuccessDiv">
                                    <div class="alert alert-success">
                                        <i class="fas fa-check-circle me-2"></i>Registration successful!
                                    </div>
                                    <a href="/recommendations" class="btn btn-success btn-lg">
                                        <i class="fas fa-chart-line me-2"></i>View Recommendations
                                    </a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container text-center">
            <p>&copy; 2024 Business Matchmaking Platform. Powered by Foursquare APIs & AI.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Speedometer-like counting animation
        function animateCounter(element, target, duration = 2000) {
            let start = 0;
            const increment = target / (duration / 16); // 60fps
            const timer = setInterval(() => {
                start += increment;
                if (start >= target) {
                    element.textContent = target;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(start);
                }
            }, 16);
        }

        // Initialize counters when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load real stats from backend
            loadStatsAndAnimate();
        });

        // Load stats and animate counters
        async function loadStatsAndAnimate() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                
                // Animate each counter with real data
                setTimeout(() => {
                    animateCounter(document.getElementById('propertyCount'), stats.total_property_owners);
                }, 500);
                
                setTimeout(() => {
                    animateCounter(document.getElementById('franchiseCount'), stats.total_franchise_companies);
                }, 800);
                
                setTimeout(() => {
                    animateCounter(document.getElementById('entrepreneurCount'), stats.total_entrepreneurs);
                }, 1100);
            } catch (error) {
                console.error('Error loading stats:', error);
                // Fallback to 0 if API fails
                setTimeout(() => {
                    animateCounter(document.getElementById('propertyCount'), 0);
                }, 500);
                
                setTimeout(() => {
                    animateCounter(document.getElementById('franchiseCount'), 0);
                }, 800);
                
                setTimeout(() => {
                    animateCounter(document.getElementById('entrepreneurCount'), 0);
                }, 1100);
            }
        }

        // Load platform stats
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                document.getElementById('propertyCount').textContent = stats.total_property_owners;
                document.getElementById('franchiseCount').textContent = stats.total_franchise_companies;
                document.getElementById('entrepreneurCount').textContent = stats.total_entrepreneurs;
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

                 // Show registration form based on user type
         function showRegistrationForm(userType) {
             // Add click animation
             const clickedCard = event.currentTarget;
             clickedCard.style.transform = 'scale(0.95)';
             setTimeout(() => {
                 clickedCard.style.transform = '';
             }, 150);
             
             // Hide all forms with fade out
             const forms = ['property-owner-form', 'franchise-company-form', 'entrepreneur-form'];
             forms.forEach(formId => {
                 const form = document.getElementById(formId);
                 form.style.opacity = '0';
                 form.style.transform = 'translateY(20px)';
                 setTimeout(() => {
                     form.style.display = 'none';
                 }, 200);
             });
 
             // Show selected form with fade in
             setTimeout(() => {
                 const selectedForm = document.getElementById(userType + '-form');
                 selectedForm.style.display = 'block';
                 selectedForm.style.opacity = '0';
                 selectedForm.style.transform = 'translateY(20px)';
                 
                 setTimeout(() => {
                     selectedForm.style.transition = 'all 0.5s ease';
                     selectedForm.style.opacity = '1';
                     selectedForm.style.transform = 'translateY(0)';
                 }, 50);
             }, 250);
         }

        // Handle form submissions
        document.getElementById('propertyOwnerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.getElementById('propertySubmitBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnSpinner = submitBtn.querySelector('.btn-spinner');
            const successDiv = document.getElementById('propertySuccessDiv');
            
            btnText.classList.add('d-none');
            btnSpinner.classList.remove('d-none');
            submitBtn.disabled = true;
            successDiv.classList.add('d-none');
            
            const formData = new FormData(e.target);
                         const data = {
                 name: formData.get('name'),
                 email: formData.get('email'),
                 phone: formData.get('phone'),
                 rent_amount: formData.get('rent_amount') && formData.get('rent_amount').trim() !== '' ? parseFloat(formData.get('rent_amount')) : 0.0,
                 sale_price: formData.get('sale_price') && formData.get('sale_price').trim() !== '' ? parseFloat(formData.get('sale_price')) : 0.0,
                 property_details: {
                     property_type: formData.get('property_type'),
                     area_sqft: parseFloat(formData.get('size')),
                     address: formData.get('address'),
                     current_rent: formData.get('rent_amount') && formData.get('rent_amount').trim() !== '' ? parseFloat(formData.get('rent_amount')) : 0.0,
                     asking_price: formData.get('sale_price') && formData.get('sale_price').trim() !== '' ? parseFloat(formData.get('sale_price')) : 0.0,
                     location: {
                         pincode: formData.get('pincode'),
                         address: formData.get('address')
                     }
                 }
             };

            try {
                const response = await fetch('/api/users/property-owner', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                
                // Show success state
                btnText.classList.remove('d-none');
                btnSpinner.classList.add('d-none');
                submitBtn.disabled = false;
                successDiv.classList.remove('d-none');
                
                // Clear all cached data to ensure fresh data is loaded
                localStorage.removeItem('bm_overview_recommendations_v1');
                localStorage.removeItem('bm_overview_recommendations_time_v1');
                localStorage.removeItem('bm_overview_pending_v1');
                
                // Incrementally update cached overview for fast Recommendations load
                try {
                    // Use the result from registration which has the properly converted location data
                    const resp = await fetch(`/api/overview/property-owner`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            user_id: result.user_id,
                            name: data.name,
                            email: data.email,
                            phone: data.phone,
                            rent_amount: data.rent_amount,
                            sale_price: data.sale_price,
                            property_details: {
                                ...data.property_details,
                                location: {
                                    ...data.property_details.location,
                                    latitude: result.location_data?.coordinates?.split(',')[0]?.trim(),
                                    longitude: result.location_data?.coordinates?.split(',')[1]?.trim(),
                                    city: result.location_data?.city,
                                    state: result.location_data?.state,
                                    country: 'IN'
                                }
                            }
                        })
                    });
                    if (resp.ok) {
                        const ownerItem = await resp.json();
                        const cacheKey = 'bm_overview_recommendations_v1';
                        const tsKey = 'bm_overview_recommendations_time_v1';
                        const raw = localStorage.getItem(cacheKey);
                        const data = raw ? JSON.parse(raw) : { property_owners: [], franchise_companies: [], entrepreneurs: [] };
                        // ensure containers
                        data.property_owners = Array.isArray(data.property_owners) ? data.property_owners : [];
                        // upsert by user_id
                        const idx = data.property_owners.findIndex(o => o.user_id === ownerItem.user_id);
                        if (idx >= 0) data.property_owners[idx] = ownerItem; else data.property_owners.unshift(ownerItem);
                        localStorage.setItem(cacheKey, JSON.stringify(data));
                        localStorage.setItem(tsKey, String(Date.now()));
                        // queue for recommendations page auto-add (cross-tab support)
                        try {
                            const pendKey = 'bm_overview_pending_v1';
                            const pendRaw = localStorage.getItem(pendKey);
                            const pend = pendRaw ? JSON.parse(pendRaw) : [];
                            pend.unshift({ type: 'property_owner', user_id: ownerItem.user_id, snapshot: ownerItem });
                            localStorage.setItem(pendKey, JSON.stringify(pend));
                        } catch {}
                    }
                } catch {}
                loadStats();
            } catch (error) {
                // Reset button state on error
                btnText.classList.remove('d-none');
                btnSpinner.classList.add('d-none');
                submitBtn.disabled = false;
                alert('Registration failed: ' + error.message);
            }
        });

        document.getElementById('franchiseCompanyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.getElementById('franchiseSubmitBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnSpinner = submitBtn.querySelector('.btn-spinner');
            const successDiv = document.getElementById('franchiseSuccessDiv');
            
            btnText.classList.add('d-none');
            btnSpinner.classList.remove('d-none');
            submitBtn.disabled = true;
            successDiv.classList.add('d-none');
            
            const formData = new FormData(e.target);
            const data = {
                company_name: formData.get('company_name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                franchise_requirements: {
                    category: formData.get('category'),
                    investment_required: parseFloat(formData.get('investment_required')),
                    area_size: parseFloat(formData.get('area_size')),
                    description: formData.get('description'),
                    pincode: formData.get('pincode'),
                    location_description: formData.get('location_description') || null
                }
            };

            try {
                const response = await fetch('/api/users/franchise-company', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                
                // Show success state
                btnText.classList.remove('d-none');
                btnSpinner.classList.add('d-none');
                submitBtn.disabled = false;
                successDiv.classList.remove('d-none');
                
                // Clear all cached data to ensure fresh data is loaded
                localStorage.removeItem('bm_overview_recommendations_v1');
                localStorage.removeItem('bm_overview_recommendations_time_v1');
                localStorage.removeItem('bm_overview_pending_v1');
                
                loadStats();
            } catch (error) {
                // Reset button state on error
                btnText.classList.remove('d-none');
                btnSpinner.classList.add('d-none');
                submitBtn.disabled = false;
                alert('Registration failed: ' + error.message);
            }
        });

        document.getElementById('entrepreneurForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.getElementById('entrepreneurSubmitBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnSpinner = submitBtn.querySelector('.btn-spinner');
            const successDiv = document.getElementById('entrepreneurSuccessDiv');
            
            btnText.classList.add('d-none');
            btnSpinner.classList.remove('d-none');
            submitBtn.disabled = true;
            successDiv.classList.add('d-none');
            
            const formData = new FormData(e.target);
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                entrepreneur_type: formData.get('entrepreneur_type'),
                budget: parseFloat(formData.get('budget')),
                pincode: formData.get('pincode'),
                business_idea: formData.get('business_idea') || null
            };

            try {
                const response = await fetch('/api/users/entrepreneur', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                const result = await response.json();
                
                // Show success state
                btnText.classList.remove('d-none');
                btnSpinner.classList.add('d-none');
                submitBtn.disabled = false;
                successDiv.classList.remove('d-none');
                
                // Clear all cached data to ensure fresh data is loaded
                localStorage.removeItem('bm_overview_recommendations_v1');
                localStorage.removeItem('bm_overview_recommendations_time_v1');
                localStorage.removeItem('bm_overview_pending_v1');
                
                // Incrementally update cached overview for entrepreneur
                try {
                    const resp = await fetch(`/api/overview/entrepreneur`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            user_id: result.user_id,
                            name: data.name,
                            email: data.email,
                            phone: data.phone,
                            entrepreneur_type: data.entrepreneur_type,
                            budget: data.budget,
                            pincode: data.pincode,
                            location_data: result.location_data || null,
                            business_idea: data.business_idea || null
                        })
                    });
                    if (resp.ok) {
                        const entItem = await resp.json();
                        const cacheKey = 'bm_overview_recommendations_v1';
                        const tsKey = 'bm_overview_recommendations_time_v1';
                        const raw = localStorage.getItem(cacheKey);
                        const dataCache = raw ? JSON.parse(raw) : { property_owners: [], franchise_companies: [], entrepreneurs: [] };
                        dataCache.entrepreneurs = Array.isArray(dataCache.entrepreneurs) ? dataCache.entrepreneurs : [];
                        const idx = dataCache.entrepreneurs.findIndex(e => e.user_id === entItem.user_id);
                        if (idx >= 0) dataCache.entrepreneurs[idx] = entItem; else dataCache.entrepreneurs.unshift(entItem);
                        localStorage.setItem(cacheKey, JSON.stringify(dataCache));
                        localStorage.setItem(tsKey, String(Date.now()));
                        // queue for recommendations page auto-add
                        try {
                            const pendKey = 'bm_overview_pending_v1';
                            const pendRaw = localStorage.getItem(pendKey);
                            const pend = pendRaw ? JSON.parse(pendRaw) : [];
                            pend.unshift({ type: 'entrepreneur', user_id: entItem.user_id, snapshot: entItem });
                            localStorage.setItem(pendKey, JSON.stringify(pend));
                        } catch {}
                    }
                } catch {}
                loadStats();
            } catch (error) {
                // Reset button state on error
                btnText.classList.remove('d-none');
                btnSpinner.classList.add('d-none');
                submitBtn.disabled = false;
                alert('Registration failed: ' + error.message);
            }
        });

        // Load stats on page load
        loadStats();
    </script>
</body>
</html>
